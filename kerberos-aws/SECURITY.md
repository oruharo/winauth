# セキュリティガイド

## ⚠️ 重要なセキュリティ注意事項

このプロジェクトはKerberos認証環境の構築を行うため、セキュリティ設定には十分な注意が必要です。

## 🔒 機密情報の取り扱い

### 絶対にGitHubに公開してはならないファイル

以下のファイルは `.gitignore` で除外されていますが、絶対にコミットしないでください：

- `*.keytab` - Kerberosキータブファイル（認証キーが含まれる）
- `*.key` - SSL/TLS秘密鍵
- `*.pem` - 証明書・秘密鍵ファイル
- `ansible/inventory/inventory.yml` - 動的生成されるインベントリファイル
- 設定ファイル内のパスワード

### パスワード管理

**デフォルトパスワードは本番環境で使用しないでください:**

```bash
# 推奨：独自のパスワードを設定
make deploy KEY_NAME=your-key \
  ADMIN_PASSWORD="YourSecureAdminPass123!" \
  USER_PASSWORD="YourSecureUserPass123!" \
  SERVICE_PASSWORD="YourSecureServicePass123!" \
  TRUST_PASSWORD="YourSecureTrustPass123!"
```

## 🛡️ セキュリティベストプラクティス

### 1. パスワード要件
- 最低12文字以上
- 大文字・小文字・数字・記号を含む
- 辞書攻撃に耐性のある複雑なパスワード

### 2. AWS設定
- EC2インスタンスはプライベートサブネットに配置推奨
- セキュリティグループで不要なポートを閉じる
- CloudTrail でアクセスログを記録

### 3. 証明書管理
- SSL証明書は自動生成される自己署名証明書です
- 本番環境では正式な証明書を使用してください
- 証明書の有効期限を定期的に確認

### 4. ネットワークセキュリティ
- VPCの適切な設定
- NACLとセキュリティグループの最小権限原則
- 不要な通信の遮断

## 🔍 セキュリティ監査

### 定期的な確認事項

1. **パスワードの強度確認**
   ```bash
   # パスワード複雑性の確認
   echo "パスワードは12文字以上で複雑性要件を満たしていますか？"
   ```

2. **不要なファイルの確認**
   ```bash
   # 機密ファイルがコミットされていないか確認
   git status --ignored
   ```

3. **ログの確認**
   ```bash
   # 異常なアクセスがないか確認
   aws logs describe-log-groups
   ```

## 🚨 セキュリティインシデント対応

### 機密情報の誤コミット時の対応

1. **即座にファイルを削除**
   ```bash
   git rm ファイル名
   git commit -m "Remove sensitive file"
   ```

2. **履歴からの完全削除（注意：破壊的操作）**
   ```bash
   git filter-branch --force --index-filter \
     'git rm --cached --ignore-unmatch ファイル名' \
     --prune-empty --tag-name-filter cat -- --all
   ```

3. **関連する認証情報の更新**
   - パスワードの変更
   - キーの再生成
   - 証明書の更新

## 📞 セキュリティ問題の報告

セキュリティ脆弱性を発見した場合は、公開リポジトリのIssueではなく、プライベートチャンネルで報告してください。

---

**⚠️ 警告**: このプロジェクトは教育・検証目的で作成されています。本番環境での使用時は、追加のセキュリティ対策を実装してください。